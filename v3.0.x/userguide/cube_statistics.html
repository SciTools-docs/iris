

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cube statistics &mdash; Iris 3.0.0rc0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Cube maths" href="cube_maths.html" />
    <link rel="prev" title="Merge and concatenate" href="merge_and_concat.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/iris-logo-title.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generated/gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="iris_cubes.html">Iris data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="loading_iris_cubes.html">Loading Iris cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving_iris_cubes.html">Saving Iris cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="navigating_a_cube.html">Navigating a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="subsetting_a_cube.html">Subsetting a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="real_and_lazy_data.html">Real and lazy data</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting_a_cube.html">Plotting a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation_and_regridding.html">Cube interpolation and regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="merge_and_concat.html">Merge and concatenate</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cube statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#collapsing-entire-data-dimensions">Collapsing entire data dimensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#area-averaging">Area averaging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#partially-reducing-data-dimensions">Partially reducing data dimensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aggregation-of-grouped-data">Aggregation of grouped data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cube_maths.html">Cube maths</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citing Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_maintenance.html">Code maintenance</a></li>
</ul>
<p class="caption"><span class="caption-text">Further Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../further_topics/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../further_topics/metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../further_topics/lenient_metadata.html">Lenient metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../further_topics/lenient_maths.html">Lenient cube maths</a></li>
</ul>
<p class="caption"><span class="caption-text">Developers Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/contributing_getting_involved.html">Getting involved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/gitwash/index.html">Working with Iris source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/contributing_documentation.html">Contributing to the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/contributing_codebase_index.html">Contributing to the code base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/contributing_changes.html">Contributing your changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/release.html">Releases</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../generated/api/iris.html">Iris API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew/index.html">What’s new in Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techpapers/index.html">Iris technical papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Iris copyright, licensing and contributors</a></li>
</ul>

            
          

    
    
    
        <p class="caption">
            <span class="caption-text">
            
                Support
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/SciTools/iris"><i class="fa fa-github fa-fw"></i> Source code</a></li>
            
                <li class="toctree-l1"><a href="https://groups.google.com/forum/#!forum/scitools-iris"><i class="fa fa-comments fa-fw"></i> Users Google Group</a></li>
            
                <li class="toctree-l1"><a href="https://groups.google.com/forum/#!forum/scitools-iris-dev"><i class="fa fa-comments fa-fw"></i> Developers Google Group</a></li>
            
                <li class="toctree-l1"><a href="https://stackoverflow.com/questions/tagged/python-iris"><i class="fa fa-question fa-fw"></i> StackOverflow for "How do I?"</a></li>
            
                <li class="toctree-l1"><a href="https://scitools.org.uk/iris/docs/v2.4.0/index.html"><i class="fa fa-book fa-fw"></i> Legacy documentation</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Iris</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Cube statistics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/userguide/cube_statistics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cube-statistics">
<span id="id1"></span><h1>Cube statistics<a class="headerlink" href="#cube-statistics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="collapsing-entire-data-dimensions">
<span id="cube-statistics-collapsing"></span><h2>Collapsing entire data dimensions<a class="headerlink" href="#collapsing-entire-data-dimensions" title="Permalink to this headline">¶</a></h2>
<p>In the <a class="reference internal" href="subsetting_a_cube.html"><span class="doc">Subsetting a cube</span></a> section we saw how to extract a subset of a
cube in order to reduce either its dimensionality or its resolution.
Instead of simply extracting a sub-region of the data,
we can produce statistical functions of the data values
across a particular dimension,
such as a ‘mean over time’ or ‘minimum over latitude’.</p>
<p id="cube-statistics-forecast-printout">For instance, suppose we have a cube:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">iris</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">sample_data_path</span><span class="p">(</span><span class="s1">&#39;uk_hires.pp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_cube</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;air_potential_temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
<span class="go">air_potential_temperature / (K)     (time: 3; model_level_number: 7; grid_latitude: 204; grid_longitude: 187)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          time                           x                      -                 -                    -</span>
<span class="go">          model_level_number             -                      x                 -                    -</span>
<span class="go">          grid_latitude                  -                      -                 x                    -</span>
<span class="go">          grid_longitude                 -                      -                 -                    x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          forecast_period                x                      -                 -                    -</span>
<span class="go">          level_height                   -                      x                 -                    -</span>
<span class="go">          sigma                          -                      x                 -                    -</span>
<span class="go">          surface_altitude               -                      -                 x                    x</span>
<span class="go">     Derived coordinates:</span>
<span class="go">          altitude                       -                      x                 x                    x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          forecast_reference_time: 2009-11-19 04:00:00</span>
<span class="go">     Attributes:</span>
<span class="go">          STASH: m01s00i004</span>
<span class="go">          source: Data from Met Office Unified Model</span>
<span class="go">          um_version: 7.3</span>
</pre></div>
</div>
<p>In this case we have a 4 dimensional cube;
to mean the vertical (z) dimension down to a single valued extent
we can pass the coordinate name and the aggregation definition to the
<a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube.collapsed" title="iris.cube.Cube.collapsed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cube.collapsed()</span></code></a> method:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">iris.analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vertical_mean</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">collapsed</span><span class="p">(</span><span class="s1">&#39;model_level_number&#39;</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MEAN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">vertical_mean</span><span class="p">)</span>
<span class="go">air_potential_temperature / (K)     (time: 3; grid_latitude: 204; grid_longitude: 187)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          time                           x                 -                    -</span>
<span class="go">          grid_latitude                  -                 x                    -</span>
<span class="go">          grid_longitude                 -                 -                    x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          forecast_period                x                 -                    -</span>
<span class="go">          surface_altitude               -                 x                    x</span>
<span class="go">     Derived coordinates:</span>
<span class="go">          altitude                       -                 x                    x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          forecast_reference_time: 2009-11-19 04:00:00</span>
<span class="go">          level_height: 696.6666 m, bound=(0.0, 1393.3333) m</span>
<span class="go">          model_level_number: 10, bound=(1, 19)</span>
<span class="go">          sigma: 0.92292976, bound=(0.8458596, 1.0)</span>
<span class="go">     Attributes:</span>
<span class="go">          STASH: m01s00i004</span>
<span class="go">          source: Data from Met Office Unified Model</span>
<span class="go">          um_version: 7.3</span>
<span class="go">     Cell methods:</span>
<span class="go">          mean: model_level_number</span>
</pre></div>
</div>
<p>Similarly other analysis operators such as <code class="docutils literal notranslate"><span class="pre">MAX</span></code>, <code class="docutils literal notranslate"><span class="pre">MIN</span></code> and <code class="docutils literal notranslate"><span class="pre">STD_DEV</span></code>
can be used instead of <code class="docutils literal notranslate"><span class="pre">MEAN</span></code>, see <a class="reference internal" href="../generated/api/iris/analysis.html#module-iris.analysis" title="iris.analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">iris.analysis</span></code></a> for a full list
of currently supported operators.</p>
<p>For an example of using this functionality, the
<a class="reference internal" href="../generated/gallery/meteorology/plot_hovmoller.html#sphx-glr-generated-gallery-meteorology-plot-hovmoller-py"><span class="std std-ref">Hovmoller diagram of monthly surface temperature</span></a>
example found
in the gallery takes a zonal mean of an <code class="docutils literal notranslate"><span class="pre">XYT</span></code> cube by using the
<code class="docutils literal notranslate"><span class="pre">collapsed</span></code> method with <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">iris.analysis.MEAN</span></code> as arguments.</p>
<div class="section" id="area-averaging">
<span id="cube-statistics-collapsing-average"></span><h3>Area averaging<a class="headerlink" href="#area-averaging" title="Permalink to this headline">¶</a></h3>
<p>Some operators support additional keywords to the <code class="docutils literal notranslate"><span class="pre">cube.collapsed</span></code> method.
For example, <a class="reference internal" href="../generated/api/iris/analysis.html#iris.analysis.MEAN" title="iris.analysis.MEAN"><code class="xref py py-func docutils literal notranslate"><span class="pre">iris.analysis.MEAN</span></code></a> supports
a weights keyword which can be combined with
<a class="reference internal" href="../generated/api/iris/analysis/cartography.html#iris.analysis.cartography.area_weights" title="iris.analysis.cartography.area_weights"><code class="xref py py-func docutils literal notranslate"><span class="pre">iris.analysis.cartography.area_weights()</span></code></a> to calculate an area average.</p>
<p>Let’s use the same data as was loaded in the previous example.
Since <code class="docutils literal notranslate"><span class="pre">grid_latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">grid_longitude</span></code> were both point coordinates
we must guess bound positions for them
in order to calculate the area of the grid boxes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iris.analysis.cartography</span>
<span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;grid_latitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">guess_bounds</span><span class="p">()</span>
<span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;grid_longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">guess_bounds</span><span class="p">()</span>
<span class="n">grid_areas</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">cartography</span><span class="o">.</span><span class="n">area_weights</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
</pre></div>
</div>
<p>These areas can now be passed to the <code class="docutils literal notranslate"><span class="pre">collapsed</span></code> method as weights:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_cube</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">collapsed</span><span class="p">([</span><span class="s1">&#39;grid_longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;grid_latitude&#39;</span><span class="p">],</span> <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MEAN</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">grid_areas</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">new_cube</span><span class="p">)</span>
<span class="go">air_potential_temperature / (K)     (time: 3; model_level_number: 7)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          time                           x                      -</span>
<span class="go">          model_level_number             -                      x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          forecast_period                x                      -</span>
<span class="go">          level_height                   -                      x</span>
<span class="go">          sigma                          -                      x</span>
<span class="go">     Derived coordinates:</span>
<span class="go">          altitude                       -                      x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          forecast_reference_time: 2009-11-19 04:00:00</span>
<span class="go">          grid_latitude: 1.5145501 degrees, bound=(0.14430022, 2.8848) degrees</span>
<span class="go">          grid_longitude: 358.74948 degrees, bound=(357.494, 360.00497) degrees</span>
<span class="go">          surface_altitude: 399.625 m, bound=(-14.0, 813.25) m</span>
<span class="go">     Attributes:</span>
<span class="go">          STASH: m01s00i004</span>
<span class="go">          source: Data from Met Office Unified Model</span>
<span class="go">          um_version: 7.3</span>
<span class="go">     Cell methods:</span>
<span class="go">          mean: grid_longitude, grid_latitude</span>
</pre></div>
</div>
<p>Several examples of area averaging exist in the gallery which may be of interest,
including an example on taking a <a class="reference internal" href="../generated/gallery/meteorology/plot_COP_1d.html#sphx-glr-generated-gallery-meteorology-plot-cop-1d-py"><span class="std std-ref">global area-weighted mean</span></a>.</p>
</div>
</div>
<div class="section" id="partially-reducing-data-dimensions">
<span id="cube-statistics-aggregated-by"></span><h2>Partially reducing data dimensions<a class="headerlink" href="#partially-reducing-data-dimensions" title="Permalink to this headline">¶</a></h2>
<p>Instead of completely collapsing a dimension, other methods can be applied
to reduce or filter the number of data points of a particular dimension.</p>
<div class="section" id="aggregation-of-grouped-data">
<h3>Aggregation of grouped data<a class="headerlink" href="#aggregation-of-grouped-data" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube.aggregated_by" title="iris.cube.Cube.aggregated_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Cube.aggregated_by</span></code></a> operation
combines data for all points with the same value of a given coordinate.
To do this, you need a coordinate whose points take on only a limited set
of different values – the <em>number</em> of these then determines the size of the
reduced dimension.
The <a class="reference internal" href="../generated/api/iris/coord_categorisation.html#module-iris.coord_categorisation" title="iris.coord_categorisation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">iris.coord_categorisation</span></code></a> module can be used to make such
‘categorical’ coordinates out of ordinary ones: The most common use is
to aggregate data over regular <em>time intervals</em>,
such as by calendar month or day of the week.</p>
<p>For example, let’s create two new coordinates on the cube
to represent the climatological seasons and the season year respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">iris.coord_categorisation</span>

<span class="n">filename</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">sample_data_path</span><span class="p">(</span><span class="s1">&#39;ostia_monthly.nc&#39;</span><span class="p">)</span>
<span class="n">cube</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_cube</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;surface_temperature&#39;</span><span class="p">)</span>

<span class="n">iris</span><span class="o">.</span><span class="n">coord_categorisation</span><span class="o">.</span><span class="n">add_season</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;clim_season&#39;</span><span class="p">)</span>
<span class="n">iris</span><span class="o">.</span><span class="n">coord_categorisation</span><span class="o">.</span><span class="n">add_season_year</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;season_year&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ‘season year’ is not the same as year number, because (e.g.) the months
Dec11, Jan12 + Feb12 all belong to ‘DJF-12’.
See <a class="reference internal" href="../generated/api/iris/coord_categorisation.html#iris.coord_categorisation.add_season_year" title="iris.coord_categorisation.add_season_year"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iris.coord_categorisation.add_season_year()</span></code></a>.</p>
</div>
<p>Printing this cube now shows that two extra coordinates exist on the cube:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
<span class="go">surface_temperature / (K)           (time: 54; latitude: 18; longitude: 432)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          time                           x             -              -</span>
<span class="go">          latitude                       -             x              -</span>
<span class="go">          longitude                      -             -              x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          clim_season                    x             -              -</span>
<span class="go">          forecast_reference_time        x             -              -</span>
<span class="go">          season_year                    x             -              -</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          forecast_period: 0 hours</span>
<span class="go">     Attributes:</span>
<span class="go">          Conventions: CF-1.5</span>
<span class="go">          STASH: m01s00i024</span>
<span class="go">     Cell methods:</span>
<span class="go">          mean: month, year</span>
</pre></div>
</div>
<p>These two coordinates can now be used to aggregate by season and climate-year:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annual_seasonal_mean</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">aggregated_by</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;clim_season&#39;</span><span class="p">,</span> <span class="s1">&#39;season_year&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">iris</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">MEAN</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">annual_seasonal_mean</span><span class="p">))</span>
<span class="go">&lt;iris &#39;Cube&#39; of surface_temperature / (K) (time: 19; latitude: 18; longitude: 432)&gt;</span>
</pre></div>
</div>
<p>The primary change in the cube is that the cube’s data has been
reduced in the ‘time’ dimension by aggregation (taking means, in this case).
This has collected together all data points with the same values of season and
season-year.
The results are now indexed by the 19 different possible values of season and
season-year in a new, reduced ‘time’ dimension.</p>
<p>We can see this by printing the first 10 values of season+year
from the original cube:  These points are individual months,
so adjacent ones are often in the same season:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">season</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;clim_season&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">cube</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;season_year&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">points</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">season</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">))</span>
<span class="go">mam 2006</span>
<span class="go">mam 2006</span>
<span class="go">jja 2006</span>
<span class="go">jja 2006</span>
<span class="go">jja 2006</span>
<span class="go">son 2006</span>
<span class="go">son 2006</span>
<span class="go">son 2006</span>
<span class="go">djf 2007</span>
<span class="go">djf 2007</span>
</pre></div>
</div>
<p>Compare this with the first 10 values of the new cube’s coordinates:
All the points now have distinct season+year values:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">season</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">annual_seasonal_mean</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;clim_season&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">annual_seasonal_mean</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;season_year&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">points</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">season</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">))</span>
<span class="go">mam 2006</span>
<span class="go">jja 2006</span>
<span class="go">son 2006</span>
<span class="go">djf 2007</span>
<span class="go">mam 2007</span>
<span class="go">jja 2007</span>
<span class="go">son 2007</span>
<span class="go">djf 2008</span>
<span class="go">mam 2008</span>
<span class="go">jja 2008</span>
</pre></div>
</div>
<p>Because the original data started in April 2006 we have some incomplete seasons
(e.g. there were only two months worth of data for ‘mam-2006’).
In this case we can fix this by removing all of the resultant ‘times’ which
do not cover a three month period (note: judged here as &gt; 3*28 days):</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tdelta_3mth</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">28</span><span class="o">*</span><span class="mf">24.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spans_three_months</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">tdelta_3mth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">three_months_bound</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">spans_three_months</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_season_means</span> <span class="o">=</span> <span class="n">annual_seasonal_mean</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">three_months_bound</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_season_means</span>
<span class="go">&lt;iris &#39;Cube&#39; of surface_temperature / (K) (time: 17; latitude: 18; longitude: 432)&gt;</span>
</pre></div>
</div>
<p>The final result now represents the seasonal mean temperature for 17 seasons
from jja-2006 to jja-2010:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">season</span><span class="p">,</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">full_season_means</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;clim_season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">full_season_means</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s1">&#39;season_year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">points</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">season</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">))</span>
<span class="go">jja 2006</span>
<span class="go">son 2006</span>
<span class="go">djf 2007</span>
<span class="go">mam 2007</span>
<span class="go">jja 2007</span>
<span class="go">son 2007</span>
<span class="go">djf 2008</span>
<span class="go">mam 2008</span>
<span class="go">jja 2008</span>
<span class="go">son 2008</span>
<span class="go">djf 2009</span>
<span class="go">mam 2009</span>
<span class="go">jja 2009</span>
<span class="go">son 2009</span>
<span class="go">djf 2010</span>
<span class="go">mam 2010</span>
<span class="go">jja 2010</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cube_maths.html" class="btn btn-neutral float-right" title="Cube maths" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="merge_and_concat.html" class="btn btn-neutral float-left" title="Merge and concatenate" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        
        &copy; <a href="../copyright.html">Copyright</a> Iris Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>