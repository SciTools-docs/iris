

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lenient cube maths &mdash; Iris 3.0.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Contributing to the documentation" href="../developers_guide/contributing_documentation.html" />
    <link rel="prev" title="Lenient metadata" href="lenient_metadata.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/iris-logo-title.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generated/gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userguide/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/iris_cubes.html">Iris data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/loading_iris_cubes.html">Loading Iris cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/saving_iris_cubes.html">Saving Iris cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/navigating_a_cube.html">Navigating a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/subsetting_a_cube.html">Subsetting a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/real_and_lazy_data.html">Real and lazy data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/plotting_a_cube.html">Plotting a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/interpolation_and_regridding.html">Cube interpolation and regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/merge_and_concat.html">Merge and concatenate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/cube_statistics.html">Cube statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/cube_maths.html">Cube maths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/citation.html">Citing Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/code_maintenance.html">Code maintenance</a></li>
</ul>
<p class="caption"><span class="caption-text">Further Topics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="lenient_metadata.html">Lenient metadata</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lenient cube maths</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lenient-example">Lenient example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#control-the-behaviour">Control the behaviour</a></li>
<li class="toctree-l2"><a class="reference internal" href="#strict-example">Strict example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finer-detail">Finer detail</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developers Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/contributing_documentation.html">Contributing to the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/documenting/index.html">Documentation in Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/gitwash/index.html">Working with Iris source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/code_format.html">Code formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/pulls.html">Pull request check list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/tests.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/deprecations.html">Deprecations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers_guide/release.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generated/api/iris.html">Iris API</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew/index.html">Whatâ€™s new in Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../techpapers/index.html">Iris technical papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Iris copyright, licensing and contributors</a></li>
</ul>

            
          

    
    
    
        <p class="caption">
            <span class="caption-text">
            
                Support
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/SciTools/iris"><i class="fa fa-github fa-fw"></i> Source code</a></li>
            
                <li class="toctree-l1"><a href="https://groups.google.com/forum/#!forum/scitools-iris"><i class="fa fa-comments fa-fw"></i> Users Google Group</a></li>
            
                <li class="toctree-l1"><a href="https://groups.google.com/forum/#!forum/scitools-iris-dev"><i class="fa fa-comments fa-fw"></i> Developers Google Group</a></li>
            
                <li class="toctree-l1"><a href="https://stackoverflow.com/questions/tagged/python-iris"><i class="fa fa-question fa-fw"></i> StackOverflow for "How do I?"</a></li>
            
                <li class="toctree-l1"><a href="https://scitools.org.uk/iris/docs/v2.4.0/index.html"><i class="fa fa-book fa-fw"></i> Legacy documentation</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Iris</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Lenient cube maths</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/further_topics/lenient_maths.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lenient-cube-maths">
<span id="lenient-maths"></span><h1>Lenient cube maths<a class="headerlink" href="#lenient-cube-maths" title="Permalink to this headline">Â¶</a></h1>
<p>This section provides an overview of lenient cube maths. In particular, it explains
what lenient maths involves, clarifies how it differs from normal or strict cube
maths, and demonstrates how you can exercise fine control over whether your cube
maths operations are lenient or strict.</p>
<p>Note that, lenient cube maths is the default behaviour of Iris from version
<code class="docutils literal notranslate"><span class="pre">3.0.0</span></code>.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">Â¶</a></h2>
<p>Lenient maths stands somewhat on the shoulders of giants. If youâ€™ve not already
done so, you may want to recap the material discussed in the following sections,</p>
<ul class="simple">
<li><p><a class="reference internal" href="../userguide/cube_maths.html#cube-maths"><span class="std std-ref">Cube maths</span></a>,</p></li>
<li><p><a class="reference internal" href="metadata.html#metadata"><span class="std std-ref">Metadata</span></a>,</p></li>
<li><p><a class="reference internal" href="lenient_metadata.html#lenient-metadata"><span class="std std-ref">Lenient metadata</span></a></p></li>
</ul>
<p>In addition to this, cube maths leans heavily on the <a class="reference internal" href="../generated/api/iris/common/resolve.html#module-iris.common.resolve" title="iris.common.resolve"><code class="xref py py-mod docutils literal notranslate"><span class="pre">resolve</span></code></a>
module, which provides the necessary infrastructure required by Iris to analyse
and combine each <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> operand involved in a maths operation
into the resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>. It may be worth while investing
some time to understand how the <a class="reference internal" href="../generated/api/iris/common/resolve.html#iris.common.resolve.Resolve" title="iris.common.resolve.Resolve"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resolve</span></code></a> class
underpins cube maths, and consider how it may be used in general to combine
or resolve cubes together.</p>
<p>Given these prerequisites, recall that <a class="reference internal" href="lenient_metadata.html#lenient-behaviour"><span class="std std-ref">lenient behaviour</span></a>
introduced and discussed the concept of lenient metadata; a more pragmatic and
forgiving approach to <a class="reference internal" href="lenient_metadata.html#lenient-equality"><span class="std std-ref">comparing</span></a>,
<a class="reference internal" href="lenient_metadata.html#lenient-combination"><span class="std std-ref">combining</span></a> and understanding the
<a class="reference internal" href="lenient_metadata.html#lenient-difference"><span class="std std-ref">differences</span></a> between your metadata
(<a class="reference internal" href="metadata.html#metadata-members-table"><span class="std std-numref">Table 1</span></a>). The lenient metadata philosophy introduced
there is extended to cube maths, with the view to also preserving as much common
coordinate (<a class="reference internal" href="metadata.html#metadata-classes-table"><span class="std std-numref">Table 2</span></a>) information, as well as common
metadata, between the participating <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> operands as possible.</p>
<p>Letâ€™s consolidate our understanding of lenient and strict cube maths through
a practical worked example, which weâ€™ll explore together next.</p>
</div>
<div class="section" id="lenient-example">
<span id="id1"></span><h2>Lenient example<a class="headerlink" href="#lenient-example" title="Permalink to this headline">Â¶</a></h2>
<p>Consider the following <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> of <code class="docutils literal notranslate"><span class="pre">air_potential_temperature</span></code>,
which has an <a class="reference external" href="https://cfconventions.org/Data/cf-conventions/cf-conventions-1.8/cf-conventions.html#atmosphere-hybrid-height-coordinate">atmosphere hybrid height parametric vertical coordinate</a>, and
represents the output of an low-resolution global atmospheric <code class="docutils literal notranslate"><span class="pre">experiment</span></code>,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>
<span class="go">air_potential_temperature / (K)     (model_level_number: 15; grid_latitude: 100; grid_longitude: 100)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          model_level_number                           x                  -                    -</span>
<span class="go">          grid_latitude                                -                  x                    -</span>
<span class="go">          grid_longitude                               -                  -                    x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          atmosphere_hybrid_height_coordinate          x                  -                    -</span>
<span class="go">          sigma                                        x                  -                    -</span>
<span class="go">          surface_altitude                             -                  x                    x</span>
<span class="go">     Derived coordinates:</span>
<span class="go">          altitude                                     x                  x                    x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          forecast_period: 0.0 hours</span>
<span class="go">          forecast_reference_time: 2009-09-09 17:10:00</span>
<span class="go">          time: 2009-09-09 17:10:00</span>
<span class="go">     Attributes:</span>
<span class="go">          Conventions: CF-1.5</span>
<span class="go">          STASH: m01s00i004</span>
<span class="go">          experiment-id: RT3 50</span>
<span class="go">          source: Data from Met Office Unified Model 7.04</span>
</pre></div>
</div>
<p>Consider also the following <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>, which has the same global
spatial extent, and acts as a <code class="docutils literal notranslate"><span class="pre">control</span></code>,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">control</span><span class="p">)</span>
<span class="go">air_potential_temperature / (K)     (grid_latitude: 100; grid_longitude: 100)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          grid_latitude                           x                    -</span>
<span class="go">          grid_longitude                          -                    x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          model_level_number: 1</span>
<span class="go">          time: 2009-09-09 17:10:00</span>
<span class="go">     Attributes:</span>
<span class="go">          Conventions: CF-1.7</span>
<span class="go">          STASH: m01s00i004</span>
<span class="go">          source: Data from Met Office Unified Model 7.04</span>
</pre></div>
</div>
<p>Now letâ€™s subtract these cubes in order to calculate a simple <code class="docutils literal notranslate"><span class="pre">difference</span></code>,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">difference</span> <span class="o">=</span> <span class="n">experiment</span> <span class="o">-</span> <span class="n">control</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>
<span class="go">unknown / (K)                       (model_level_number: 15; grid_latitude: 100; grid_longitude: 100)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          model_level_number                           x                  -                    -</span>
<span class="go">          grid_latitude                                -                  x                    -</span>
<span class="go">          grid_longitude                               -                  -                    x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          atmosphere_hybrid_height_coordinate          x                  -                    -</span>
<span class="go">          sigma                                        x                  -                    -</span>
<span class="go">          surface_altitude                             -                  x                    x</span>
<span class="go">     Derived coordinates:</span>
<span class="go">          altitude                                     x                  x                    x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          forecast_period: 0.0 hours</span>
<span class="go">          forecast_reference_time: 2009-09-09 17:10:00</span>
<span class="go">          time: 2009-09-09 17:10:00</span>
<span class="go">     Attributes:</span>
<span class="go">          experiment-id: RT3 50</span>
<span class="go">          source: Data from Met Office Unified Model 7.04</span>
</pre></div>
</div>
<p>Note that, cube maths automatically takes care of broadcasting the
dimensionality of the <code class="docutils literal notranslate"><span class="pre">control</span></code> up to that of the <code class="docutils literal notranslate"><span class="pre">experiment</span></code>, in order to
calculate the <code class="docutils literal notranslate"><span class="pre">difference</span></code>. This is performed only after ensuring that both
the <strong>dimension coordinates</strong> <code class="docutils literal notranslate"><span class="pre">grid_latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">grid_longitude</span></code> are first
<a class="reference internal" href="lenient_metadata.html#lenient-equality"><span class="std std-ref">leniently equivalent</span></a>.</p>
<p>As expected, the resultant <code class="docutils literal notranslate"><span class="pre">difference</span></code> contains the
<a class="reference internal" href="../generated/api/iris/aux_factory.html#iris.aux_factory.HybridHeightFactory" title="iris.aux_factory.HybridHeightFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">HybridHeightFactory</span></code></a> and all itâ€™s associated <strong>auxiliary
coordinates</strong>. However, the <strong>scalar coordinates</strong> have been leniently combined to
preserve as much coordinate information as possible, and the <code class="docutils literal notranslate"><span class="pre">attributes</span></code>
dictionaries have also been leniently combined. In addition, see what further
<a class="reference internal" href="#sanitise-metadata"><span class="std std-ref">rationalisation</span></a> is always performed by cube maths on
the resultant metadata and coordinates.</p>
<p>Also, note that the <code class="docutils literal notranslate"><span class="pre">model_level_number</span></code> <strong>scalar coordinate</strong> from the
<code class="docutils literal notranslate"><span class="pre">control</span></code> has be superseded by the similarly named <strong>dimension coordinate</strong>
from the <code class="docutils literal notranslate"><span class="pre">experiment</span></code> in the resultant <code class="docutils literal notranslate"><span class="pre">difference</span></code>.</p>
<p>Now letâ€™s compare and contrast this lenient result with the strict alternative.
But before we do so, letâ€™s first clarify how to control the behaviour of cube maths.</p>
</div>
<div class="section" id="control-the-behaviour">
<h2>Control the behaviour<a class="headerlink" href="#control-the-behaviour" title="Permalink to this headline">Â¶</a></h2>
<p>As stated earlier, lenient cube maths is the default behaviour from Iris <code class="docutils literal notranslate"><span class="pre">3.0.0</span></code>.
However, this behaviour may be controlled via the thread-safe <code class="docutils literal notranslate"><span class="pre">LENIENT[&quot;maths&quot;]</span></code>
runtime option,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">iris.common</span> <span class="kn">import</span> <span class="n">LENIENT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">LENIENT</span><span class="p">)</span>
<span class="go">Lenient(maths=True)</span>
</pre></div>
</div>
<p>Which may be set and applied globally thereafter for Iris within the current
thread of execution,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LENIENT</span><span class="p">[</span><span class="s2">&quot;maths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">LENIENT</span><span class="p">)</span>  
<span class="go">Lenient(maths=False)</span>
</pre></div>
</div>
<p>Or alternatively, temporarily alter the behaviour of cube maths only within the
scope of the <code class="docutils literal notranslate"><span class="pre">LENIENT</span></code> <a class="reference external" href="https://docs.python.org/3/library/contextlib.html">context manager</a>,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">LENIENT</span><span class="p">)</span>
<span class="go">Lenient(maths=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">LENIENT</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">maths</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">LENIENT</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">Lenient(maths=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">LENIENT</span><span class="p">)</span>
<span class="go">Lenient(maths=True)</span>
</pre></div>
</div>
</div>
<div class="section" id="strict-example">
<h2>Strict example<a class="headerlink" href="#strict-example" title="Permalink to this headline">Â¶</a></h2>
<p>Now that we know how to control the underlying behaviour of cube maths,
letâ€™s return to our <a class="reference internal" href="#lenient-example"><span class="std std-ref">lenient example</span></a>, but this
time perform <strong>strict</strong> cube maths instead,</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">LENIENT</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">maths</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">difference</span> <span class="o">=</span> <span class="n">experiment</span> <span class="o">-</span> <span class="n">control</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>
<span class="go">unknown / (K)                       (model_level_number: 15; grid_latitude: 100; grid_longitude: 100)</span>
<span class="go">     Dimension coordinates:</span>
<span class="go">          model_level_number                           x                  -                    -</span>
<span class="go">          grid_latitude                                -                  x                    -</span>
<span class="go">          grid_longitude                               -                  -                    x</span>
<span class="go">     Auxiliary coordinates:</span>
<span class="go">          atmosphere_hybrid_height_coordinate          x                  -                    -</span>
<span class="go">          sigma                                        x                  -                    -</span>
<span class="go">          surface_altitude                             -                  x                    x</span>
<span class="go">     Derived coordinates:</span>
<span class="go">          altitude                                     x                  x                    x</span>
<span class="go">     Scalar coordinates:</span>
<span class="go">          time: 2009-09-09 17:10:00</span>
<span class="go">     Attributes:</span>
<span class="go">          source: Data from Met Office Unified Model 7.04</span>
</pre></div>
</div>
<p>Although the numerical result of this strict cube maths operation is identical,
it is not as rich in metadata as the <a class="reference internal" href="#lenient-example"><span class="std std-ref">lenient alternative</span></a>.
In particular, it does not contain the <code class="docutils literal notranslate"><span class="pre">forecast_period</span></code> and <code class="docutils literal notranslate"><span class="pre">forecast_reference_time</span></code>
<strong>scalar coordinates</strong>, or the <code class="docutils literal notranslate"><span class="pre">experiment-id</span></code> in the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> dictionary.</p>
<p>This is because strict cube maths, in general, will only return common metadata
and common coordinates that are <a class="reference internal" href="metadata.html#strict-equality"><span class="std std-ref">strictly equivalent</span></a>.</p>
</div>
<div class="section" id="finer-detail">
<h2>Finer detail<a class="headerlink" href="#finer-detail" title="Permalink to this headline">Â¶</a></h2>
<p>In general, if you want to preserve as much metadata and coordinate information as
possible during cube maths, then opt to use the default lenient behaviour. Otherwise,
favour the strict alternative if you require to enforce precise metadata and
coordinate commonality.</p>
<p>The following information may also help you decide whether lenient cube maths best
suits your use case,</p>
<ul class="simple">
<li><p>lenient behaviour uses <a class="reference internal" href="lenient_metadata.html#lenient-equality"><span class="std std-ref">lenient equality</span></a> to match the
metadata of coordinates, which is more tolerant to certain metadata differences,</p></li>
<li><p>lenient behaviour uses <a class="reference internal" href="lenient_metadata.html#lenient-combination"><span class="std std-ref">lenient combination</span></a> to create
the metadata of coordinates on the resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>,</p></li>
<li><p>lenient behaviour will attempt to cover each dimension with a <a class="reference internal" href="../generated/api/iris/coords.html#iris.coords.DimCoord" title="iris.coords.DimCoord"><code class="xref py py-class docutils literal notranslate"><span class="pre">DimCoord</span></code></a>
in the resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>, even though only one <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>
operand may describe that dimension,</p></li>
<li><p>lenient behaviour will attempt to include <strong>auxiliary coordinates</strong> in the
resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> that exist on only one <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>
operand,</p></li>
<li><p>lenient behaviour will attempt to include <strong>scalar coordinates</strong> in the
resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> that exist on only one <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>
operand,</p></li>
<li><p>lenient behaviour will add a coordinate to the resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>
with <strong>bounds</strong>, even if only one of the associated matching coordinates from the
<a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> operands has <strong>bounds</strong>,</p></li>
<li><p>strict and lenient behaviour both require that the <strong>points</strong> and <strong>bounds</strong> of
matching coordinates from <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> operands must be strictly
equivalent. However, mismatching <strong>bounds</strong> of <strong>scalar coordinates</strong> are ignored
i.e., a scalar coordinate that is common to both <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> operands, with
equivalent <strong>points</strong> but different <strong>bounds</strong>, will be added to the resultant
<a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a> with but with <strong>no bounds</strong></p></li>
</ul>
<p id="sanitise-metadata">Additionally, cube maths will always perform the following rationalisation of the
resultant <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube" title="iris.cube.Cube"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cube</span></code></a>,</p>
<ul class="simple">
<li><p>clear the <code class="docutils literal notranslate"><span class="pre">standard_name</span></code>, <code class="docutils literal notranslate"><span class="pre">long_name</span></code> and <code class="docutils literal notranslate"><span class="pre">var_name</span></code>, defaulting the
<a class="reference internal" href="../generated/api/iris/common/mixin.html#iris.common.mixin.CFVariableMixin.name" title="iris.common.mixin.CFVariableMixin.name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">name()</span></code></a> to <code class="docutils literal notranslate"><span class="pre">unknown</span></code>,</p></li>
<li><p>clear the <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube.cell_methods" title="iris.cube.Cube.cell_methods"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cell_methods</span></code></a>,</p></li>
<li><p>clear the <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube.cell_measures" title="iris.cube.Cube.cell_measures"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cell_measures()</span></code></a>,</p></li>
<li><p>clear the <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube.ancillary_variables" title="iris.cube.Cube.ancillary_variables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ancillary_variables()</span></code></a>,</p></li>
<li><p>clear the <code class="docutils literal notranslate"><span class="pre">STASH</span></code> key from the <a class="reference internal" href="../generated/api/iris/cube.html#iris.cube.Cube.attributes" title="iris.cube.Cube.attributes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">attributes</span></code></a> dictionary,</p></li>
<li><p>assign the appropriate <a class="reference internal" href="../generated/api/iris/common/mixin.html#iris.common.mixin.CFVariableMixin.units" title="iris.common.mixin.CFVariableMixin.units"><code class="xref py py-attr docutils literal notranslate"><span class="pre">units</span></code></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../developers_guide/contributing_documentation.html" class="btn btn-neutral float-right" title="Contributing to the documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lenient_metadata.html" class="btn btn-neutral float-left" title="Lenient metadata" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        
        &copy; <a href="../copyright.html">Copyright</a> Iris Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>