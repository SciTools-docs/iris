

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Deriving Exner Pressure and Air Temperature &mdash; Iris 3.0.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="Global average annual temperature plot" href="plot_COP_1d.html" />
    <link rel="prev" title="Plotting wind direction using quiver" href="plot_wind_speed.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/iris-logo-title.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installing.html">Installing Iris</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#general">General</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#meteorology">Meteorology</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_TEC.html">Ionosphere space weather</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_hovmoller.html">Hovmoller diagram of monthly surface temperature</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_wind_speed.html">Plotting wind direction using quiver</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Deriving Exner Pressure and Air Temperature</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_COP_1d.html">Global average annual temperature plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_lagged_ensemble.html">Seasonal ensemble model plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="plot_COP_maps.html">Global average annual temperature maps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#oceanography">Oceanography</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/iris_cubes.html">Iris data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/loading_iris_cubes.html">Loading Iris cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/saving_iris_cubes.html">Saving Iris cubes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/navigating_a_cube.html">Navigating a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/subsetting_a_cube.html">Subsetting a Cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/real_and_lazy_data.html">Real and Lazy Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/plotting_a_cube.html">Plotting a cube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/interpolation_and_regridding.html">Cube interpolation and regridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/merge_and_concat.html">Merge and concatenate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/cube_statistics.html">Cube statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/cube_maths.html">Basic cube mathematics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/citation.html">Citing Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../userguide/code_maintenance.html">Code maintenance</a></li>
</ul>
<p class="caption"><span class="caption-text">Developers Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/contributing_documentation.html">Contributing to the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/documenting/index.html">Documentation in Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/gitwash/index.html">Working with <em>iris</em> source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/code_format.html">Code formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/pulls.html">Pull request check List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/tests.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/deprecations.html">Deprecations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers_guide/release.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/iris.html">Iris API</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../whatsnew/index.html">What’s new in Iris</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../techpapers/index.html">Iris Technical Papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../copyright.html">Iris copyright, licensing and contributors</a></li>
</ul>

            
          

    
    
    
        <p class="caption">
            <span class="caption-text">
            
                Support
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/SciTools/iris"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
                <li class="toctree-l1"><a href="https://groups.google.com/forum/#!forum/scitools-iris"><i class="fa fa-comments fa-fw"></i> Users Google Group</a></li>
            
                <li class="toctree-l1"><a href="https://groups.google.com/forum/#!forum/scitools-iris-dev"><i class="fa fa-comments fa-fw"></i> Developers Google Group</a></li>
            
                <li class="toctree-l1"><a href="https://stackoverflow.com/questions/tagged/python-iris"><i class="fa fa-question fa-fw"></i> StackOverflow For "How do I?"</a></li>
            
                <li class="toctree-l1"><a href="https://scitools.org.uk/iris/docs/v2.4.0/index.html"><i class="fa fa-book fa-fw"></i> Legacy documentation</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Iris</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Gallery</a> &raquo;</li>
        
      <li>Deriving Exner Pressure and Air Temperature</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/generated/gallery/meteorology/plot_deriving_phenomena.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-generated-gallery-meteorology-plot-deriving-phenomena-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="deriving-exner-pressure-and-air-temperature">
<span id="sphx-glr-generated-gallery-meteorology-plot-deriving-phenomena-py"></span><h1>Deriving Exner Pressure and Air Temperature<a class="headerlink" href="#deriving-exner-pressure-and-air-temperature" title="Permalink to this headline">¶</a></h1>
<p>This example shows some processing of cubes in order to derive further related
cubes; in this case the derived cubes are Exner pressure and air temperature
which are calculated by combining air pressure, air potential temperature and
specific humidity. Finally, the two new cubes are presented side-by-side in a
plot.</p>
<img alt="Exner pressure, Air temperature" class="sphx-glr-single-img" src="../../../_images/sphx_glr_plot_deriving_phenomena_001.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span>

<span class="kn">import</span> <span class="nn">iris</span>
<span class="kn">import</span> <span class="nn">iris.coords</span> <span class="k">as</span> <span class="nn">coords</span>
<span class="kn">import</span> <span class="nn">iris.iterate</span>
<span class="kn">import</span> <span class="nn">iris.plot</span> <span class="k">as</span> <span class="nn">iplt</span>
<span class="kn">import</span> <span class="nn">iris.quickplot</span> <span class="k">as</span> <span class="nn">qplt</span>


<span class="k">def</span> <span class="nf">limit_colorbar_ticks</span><span class="p">(</span><span class="n">contour_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a contour object which has an associated colorbar and limits the</span>
<span class="sd">    number of ticks on the colorbar to 4.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Under Matplotlib v1.2.x the colorbar attribute of a contour object is</span>
    <span class="c1"># a tuple containing the colorbar and an axes object, whereas under</span>
    <span class="c1"># Matplotlib v1.3.x it is simply the colorbar.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">contour_object</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="n">contour_object</span><span class="o">.</span><span class="n">colorbar</span>

    <span class="n">colorbar</span><span class="o">.</span><span class="n">locator</span> <span class="o">=</span> <a href="https://matplotlib.org/api/ticker_api.html#matplotlib.ticker.MaxNLocator" title="matplotlib.ticker.MaxNLocator" class="sphx-glr-backref-module-matplotlib-ticker sphx-glr-backref-type-py-class"><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span></a><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">colorbar</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">sample_data_path</span><span class="p">(</span><span class="s2">&quot;colpex.pp&quot;</span><span class="p">)</span>

    <span class="c1"># The list of phenomena of interest</span>
    <span class="n">phenomena</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;air_potential_temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;air_pressure&quot;</span><span class="p">]</span>

    <span class="c1"># Define the constraint on standard name and model level</span>
    <span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">iris</span><span class="o">.</span><span class="n">Constraint</span><span class="p">(</span><span class="n">phenom</span><span class="p">,</span> <span class="n">model_level_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">phenom</span> <span class="ow">in</span> <span class="n">phenomena</span>
    <span class="p">]</span>

    <span class="n">air_potential_temperature</span><span class="p">,</span> <span class="n">air_pressure</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">load_cubes</span><span class="p">(</span>
        <span class="n">fname</span><span class="p">,</span> <span class="n">constraints</span>
    <span class="p">)</span>

    <span class="c1"># Define a coordinate which represents 1000 hPa</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">AuxCoord</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">long_name</span><span class="o">=</span><span class="s2">&quot;P0&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;hPa&quot;</span><span class="p">)</span>
    <span class="c1"># Convert reference pressure &#39;p0&#39; into the same units as &#39;air_pressure&#39;</span>
    <span class="n">p0</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">air_pressure</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>

    <span class="c1"># Calculate Exner pressure</span>
    <span class="n">exner_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">air_pressure</span> <span class="o">/</span> <span class="n">p0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">287.05</span> <span class="o">/</span> <span class="mf">1005.0</span><span class="p">)</span>
    <span class="c1"># Set the name (the unit is scalar)</span>
    <span class="n">exner_pressure</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;exner_pressure&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate air_temp</span>
    <span class="n">air_temperature</span> <span class="o">=</span> <span class="n">exner_pressure</span> <span class="o">*</span> <span class="n">air_potential_temperature</span>
    <span class="c1"># Set the name (the unit is K)</span>
    <span class="n">air_temperature</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;air_temperature&quot;</span><span class="p">)</span>

    <span class="c1"># Now create an iterator which will give us lat lon slices of</span>
    <span class="c1"># exner pressure and air temperature in the form</span>
    <span class="c1"># (exner_slice, air_temp_slice).</span>
    <span class="n">lat_lon_slice_pairs</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">iterate</span><span class="o">.</span><span class="n">izip</span><span class="p">(</span>
        <span class="n">exner_pressure</span><span class="p">,</span>
        <span class="n">air_temperature</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;grid_latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_longitude&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># For the purposes of this example, we only want to demonstrate the first</span>
    <span class="c1"># plot.</span>
    <span class="n">lat_lon_slice_pairs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">lat_lon_slice_pairs</span><span class="p">)]</span>

    <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">exner_slice</span><span class="p">,</span> <span class="n">air_temp_slice</span> <span class="ow">in</span> <span class="n">lat_lon_slice_pairs</span><span class="p">:</span>
        <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">exner_slice</span><span class="p">)</span>

        <span class="c1"># The default colorbar has a few too many ticks on it, causing text to</span>
        <span class="c1"># overlap. Therefore, limit the number of ticks.</span>
        <span class="n">limit_colorbar_ticks</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>

        <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplot.html#matplotlib.pyplot.subplot" title="matplotlib.pyplot.subplot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span></a><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
        <span class="n">cont</span> <span class="o">=</span> <span class="n">qplt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">air_temp_slice</span><span class="p">)</span>
        <span class="n">limit_colorbar_ticks</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span>
        <span class="n">iplt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  2.741 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-gallery-meteorology-plot-deriving-phenomena-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/0da39698fada76be38b2bd942ec5c36b/plot_deriving_phenomena.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_deriving_phenomena.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/23d27722595e1ef9fb8f19ad2d2ded64/plot_deriving_phenomena.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_deriving_phenomena.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_COP_1d.html" class="btn btn-neutral float-right" title="Global average annual temperature plot" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_wind_speed.html" class="btn btn-neutral float-left" title="Plotting wind direction using quiver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        
        &copy; <a href="../../../copyright.html">Copyright</a> Iris Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>